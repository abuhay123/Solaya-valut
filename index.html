<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Solaya Vault</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Manifest + Icons -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icon.png">
  <link rel="apple-touch-icon" href="icon.png">
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Solaya Vault">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap" rel="stylesheet">

  <!-- ×¡×¤×¨×™×•×ª -->
  <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@latest/lib/index.iife.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bip39@3.0.4/dist/index.browser.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ed25519-hd-key@1.1.1/dist/index.umd.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bs58@5.0.0/dist/bs58.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    body {
      margin: 0;
      font-family: 'Orbitron', sans-serif;
      background: #0d0d0d;
      color: #ffffff;
    }
    #splash {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }
    #splash img {
      width: 160px;
      animation: fadeInOut 2s ease-in-out;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; }
      20% { opacity: 1; }
      80% { opacity: 1; }
      100% { opacity: 0; }
    }
    header {
      background: #111;
      padding: 20px;
      box-shadow: 0 4px 12px #000;
      text-align: center;
    }
    header h1 {
      font-size: 28px;
      margin: 0;
      animation: glow 2s infinite ease-in-out;
    }
    @keyframes glow {
      0%, 100% { color: #fff; text-shadow: 0 0 10px #00ffcc; }
      50% { color: #00ffcc; text-shadow: 0 0 20px #00ffcc; }
    }
    nav {
      display: flex;
      justify-content: space-around;
      background: #1a1a1a;
      padding: 10px 0;
    }
    nav a {
      color: #00ffcc;
      text-decoration: none;
      font-weight: bold;
      padding: 8px 16px;
      border-radius: 4px;
      transition: background 0.3s;
    }
    nav a:hover {
      background: #00ffcc;
      color: #000;
    }
    .container {
      padding: 20px;
      max-width: 600px;
      margin: auto;
    }
    input, button {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: none;
      border-radius: 6px;
      font-size: 16px;
    }
    button {
      background-color: #00ffcc;
      color: #000;
      font-weight: bold;
      cursor: pointer;
    }
    .hidden {
      display: none;
    }
    canvas {
      margin-top: 30px;
    }
  </style>
</head>
<body>

<!-- Splash Screen -->
<div id="splash">
  <img src="icon.png" alt="Solaya Logo">
  <h1>Solaya Vault</h1>
</div>

<script>
  window.addEventListener("load", () => {
    setTimeout(() => {
      document.getElementById("splash").style.display = "none";
      document.getElementById("main-content").style.display = "block";
    }, 2000);
  });
</script>

<header>
  <h1>Solaya Vault</h1>
</header>

<nav>
  <a href="#" onclick="showSection('register')">ğŸ“¥ ×”×ª×—×‘×¨×•×ª</a>
  <a href="#" onclick="showSection('wallet')">ğŸ§¾ ×”××¨× ×§</a>
  <a href="#" onclick="showSection('market')">ğŸ“Š ×©×•×§</a>
  <a href="#" onclick="showSection('settings')">âš™ï¸ ×”×’×“×¨×•×ª</a>
</nav>

<div id="app" class="container">
  <div id="register">
    <h2> ×¦×•×¨ ××¨× ×§ ×—×“×©</h2>
    <button onclick="createWallet()">×¦×•×¨ ××¨× ×§</button>
    <p id="newMnemonic" style="margin-top: 10px; color: #0ff;"></p>

    <h3> ×”×ª×—×‘×¨×•×ª ×¢× 12 ××™×œ×™×</h3>
    <input id="mnemonicInput" placeholder="twelve words..." />
    <button onclick="importWallet()">×”×ª×—×‘×¨</button>

    <h3> ×”×ª×—×‘×¨×•×ª ×¢× Private Key</h3>
    <input id="privKeyInput" placeholder="Private key (base58)" />
    <button onclick="importPrivateKey()">×”×ª×—×‘×¨ ×¢× ××¤×ª×—</button>
    <p id="loginStatus"></p>
  </div>

  <div id="wallet" class="hidden">
    <h2> ×”××¨× ×§ ×©×œ×™</h2>
    <p><strong>×›×ª×•×‘×ª:</strong> <span id="walletAddress"></span></p>
    <p><strong>×™×ª×¨×”:</strong> <span id="walletBalance"></span> SOL</p>

    <h3>×©×œ×™×—×ª SOL</h3>
    <input id="toAddress" placeholder="×›×ª×•×‘×ª ×™×¢×“" />
    <input id="amount" placeholder="×¡×›×•× ×‘-SOL" />
    <button onclick="sendSol()">×©×œ×— SOL</button>
    <p id="sendStatus"></p>
  </div>

  <div id="market" class="hidden">
    <h2> × ×ª×•× ×™ ×©×•×§</h2>
    <canvas id="priceChart" height="200"></canvas>
    <p id="marketStatus">×˜×•×¢×Ÿ...</p>
  </div>

  <div id="settings" class="hidden">
    <h2>âš™ ×”×’×“×¨×•×ª</h2>
    <ul>
      <li> ×”×—×œ×¤×ª ×¡×™×¡××”</li>
      <li> ×¤×¨×•×¤×™×œ ××™×©×™</li>
      <li> Face ID (×‘×§×¨×•×‘)</li>
    </ul>
  </div>
</div>

<footer style="background:#111; color:#ccc; padding:20px; margin-top:40px; font-size:14px; text-align:center;">
  <p>Â© 2025 Solaya Vault. ×›×œ ×”×–×›×•×™×•×ª ×©××•×¨×•×ª.</p>
</footer>

<script>
  const connection = new solanaWeb3.Connection(solanaWeb3.clusterApiUrl("mainnet-beta"));
  let keypair;

  function showSection(id) {
    document.querySelectorAll('#app > div').forEach(div => div.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
  }

  async function createWallet() {
    try {
      const mnemonic = bip39.generateMnemonic();
      const seedBuffer = await bip39.mnemonicToSeed(mnemonic);
      const derivedSeed = ed25519HdKey.derivePath("m/44'/501'/0'/0'", seedBuffer.toString("hex")).key;
      const secretKey = new Uint8Array(derivedSeed);
      keypair = solanaWeb3.Keypair.fromSeed(secretKey);

      document.getElementById("newMnemonic").innerText = "×©××•×¨ ××ª ×”××™×œ×™×: " + mnemonic;
      afterLogin();
    } catch (e) {
      alert("×©×’×™××” ×‘×™×¦×™×¨×ª ×”××¨× ×§: " + e.message);
      console.error(e);
    }
  }

  async function importWallet() {
    const mnemonic = document.getElementById("mnemonicInput").value.trim();
    const seed = await bip39.mnemonicToSeed(mnemonic);
    const derived = ed25519HdKey.derivePath("m/44'/501'/0'/0'", seed.toString('hex')).key;
    keypair = solanaWeb3.Keypair.fromSeed(derived);
    afterLogin();
  }

  async function importPrivateKey() {
    const priv = document.getElementById("privKeyInput").value.trim();
    const decoded = bs58.decode(priv);
    keypair = solanaWeb3.Keypair.fromSecretKey(decoded);
    afterLogin();
  }

  async function afterLogin() {
    const address = keypair.publicKey.toBase58();
    document.getElementById("walletAddress").innerText = address;
    const balance = await connection.getBalance(keypair.publicKey);
    document.getElementById("walletBalance").innerText = (balance / solanaWeb3.LAMPORTS_PER_SOL).toFixed(4);
    showSection('wallet');
    loadChart();
  }

  async function sendSol() {
    const to = document.getElementById("toAddress").value.trim();
    const lamports = parseFloat(document.getElementById("amount").value.trim()) * solanaWeb3.LAMPORTS_PER_SOL;
    const tx = new solanaWeb3.Transaction().add(
      solanaWeb3.SystemProgram.transfer({
        fromPubkey: keypair.publicKey,
        toPubkey: new solanaWeb3.PublicKey(to),
        lamports
      })
    );
    const signature = await solanaWeb3.sendAndConfirmTransaction(connection, tx, [keypair]);
    document.getElementById("sendStatus").innerText = "× ×©×œ×—! ×¢×¡×§×”: " + signature;
  }

  async function loadChart() {
    const res = await fetch("https://api.coingecko.com/api/v3/coins/solana/market_chart?vs_currency=usd&days=1");
    const data = await res.json();
    const prices = data.prices.map(p => p[1]);
    const labels = data.prices.map(p => new Date(p[0]).toLocaleTimeString());
    const ctx = document.getElementById("priceChart").getContext("2d");
    new Chart(ctx, {
      type: 'line',
      data: {
        labels: labels,
        datasets: [{
